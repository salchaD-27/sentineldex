# Sample GraphQL Queries for Sentineldex Subgraph

## Run graph-node first, then access GraphQL UI at:
# http://localhost:8000/subgraphs/name/sentineldex/graphql

# =====================================================
# QUERY 1: Get all TokenCores with their metadata
# =====================================================
query GetTokensWithMetadata {
  tokenCores {
    id
    address
    symbol {
      id
      value
    }
    name {
      id
      value
    }
    decimals {
      id
      value
    }
    totalSupply {
      id
      value
    }
  }
}

# =====================================================
# QUERY 2: Get all Pools with token details
# =====================================================
query GetPools {
  pools {
    id
    address
    fee
    reserve0
    reserve1
    totalSupply
    createdAt
    token0 {
      id
      address
      symbol {
        value
      }
      name {
        value
      }
    }
    token1 {
      id
      address
      symbol {
        value
      }
      name {
        value
      }
    }
  }
}

# =====================================================
# QUERY 3: Get single token with all metadata
# =====================================================
query GetTokenByAddress($tokenAddress: String!) {
  tokenCore(id: $tokenAddress) {
    id
    address
    symbol {
      value
    }
    name {
      value
    }
    decimals {
      value
    }
    totalSupply {
      value
    }
  }
}

# Variables for query 3:
# {
#   "tokenAddress": "0x..."
# }

# =====================================================
# QUERY 4: Get liquidity positions for a user
# =====================================================
query GetUserLiquidityPositions($userAddress: String!) {
  user(id: $userAddress) {
    id
    address
    liquidityPositions(first: 10) {
      id
      pool {
        id
        token0 {
          symbol { value }
        }
        token1 {
          symbol { value }
        }
      }
      liquidityTokenBalance
      token0Amount
      token1Amount
      createdAt
      updatedAt
    }
  }
}

# Variables for query 4:
# {
#   "userAddress": "0x..."
# }

# =====================================================
# QUERY 5: Get swap history for a pool
# =====================================================
query GetPoolSwaps($poolAddress: String!) {
  swaps(where: { pool: $poolAddress }, orderBy: timestamp, orderDirection: desc, first: 10) {
    id
    user {
      id
    }
    tokenIn {
      symbol { value }
    }
    tokenOut {
      symbol { value }
    }
    amountIn
    amountOut
    fee
    timestamp
  }
}

# =====================================================
# QUERY 6: Get liquidity changes (add/remove) for a pool
# =====================================================
query GetPoolLiquidityChanges($poolAddress: String!) {
  liquidityChanges(where: { pool: $poolAddress }, orderBy: timestamp, orderDirection: desc, first: 10) {
    id
    user {
      id
    }
    type
    token0Amount
    token1Amount
    liquidityAmount
    timestamp
  }
}

# =====================================================
# QUERY 7: Summary - All entities count
# =====================================================
query GetEntityCounts {
  tokenCores(first: 1) {
    __typename
  }
  tokenSymbols(first: 1) {
    __typename
  }
  pools(first: 1) {
    __typename
  }
  liquidityPositions(first: 1) {
    __typename
  }
  swaps(first: 1) {
    __typename
  }
  liquidityChanges(first: 1) {
    __typename
  }
}

# =====================================================
# QUERY 8: Simple token lookup by symbol (using exists filter)
# =====================================================
query FindTokenBySymbol {
  tokenSymbols(where: { value_contains: "Test" }) {
    id
    value
    token {
      id
      address
      decimals {
        value
      }
    }
  }
}

# =====================================================
# MUTATION-LIKE: Trigger token metadata fetch (via test)
# =====================================================
# Note: Token metadata is automatically fetched when:
# 1. A pool is created with that token
# 2. The Token template is created
# 3. The call handlers run for symbol(), name(), decimals(), totalSupply()
#
# To manually test, call any token function via eth_call:
# - symbol()
# - name()  
# - decimals()
# - totalSupply()

